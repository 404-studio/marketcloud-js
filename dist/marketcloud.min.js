!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Marketcloud=e():t.Marketcloud=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Utils=e.Storage=e.Client=void 0;var i=n(1),s=r(i),o=n(3),u=r(o),a=n(4),d=r(a),c=c||{};c.Client=s.default,c.Storage=d.default,c.Utils=u.default,"undefined"!=typeof window&&(window.Marketcloud=c),t.exports=c,e.default=c,e.Client=s.default,e.Storage=d.default,e.Utils=u.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){this.token=null,this.publicKey=t.publicKey||t.public_key,this.baseUrl="https://api.marketcloud.it",this.apiVersion="v0",this.rejectApiErrors=t.rejectApiErrors||!0,this.addresses=new c.default(this),this.brands=new l.default(this),this.categories=new y.default(this),this.carts=new p.default(this),this.collections=new v.default(this),this.coupons=new M.default(this),this.products=new R.default(this),this.orders=new S.default(this),this.invoices=new T.default(this),this.users=new F.default(this),this.contents=new b.default(this),this.files=new E.default(this),this.media=this.files,this.promotions=new C.default(this),this.shippingMethods=new L.default(this),this.shippings=this.shippingMethods,this.payments=new A.default(this),this.paymentMethods=new q.default(this),this.variables=new X.default(this),this.RETRIES=0,this.MAX_RETRIES=2,this.LAST_REQUEST=null,a.default.get("AuthenticatedUserToken")&&(this.token=a.default.get("AuthenticatedUserToken"),this.currentUser=JSON.parse(a.default.get("AuthenticatedUserData")))}Object.defineProperty(e,"__esModule",{value:!0});var s=n(2),o=r(s),u=n(4),a=r(u),d=n(5),c=r(d),f=n(7),l=r(f),h=n(8),p=r(h),m=n(9),y=r(m),_=n(10),v=r(_),w=n(11),b=r(w),P=n(12),M=r(P),g=n(13),T=r(g),O=n(14),E=r(O),j=n(15),S=r(j),k=n(16),A=r(k),U=n(17),q=r(U),x=n(18),R=r(x),N=n(19),C=r(N),H=n(20),L=r(H),I=n(21),F=r(I),G=n(22),X=r(G);i.prototype.getAuthorizationHeader=function(){var t=this.publicKey;return this.token&&(t+=":"+this.token),t},i.prototype.request=function(t,e){var n=new o.default(t,this);return n.send(e)},i.prototype.buildRequestObject=function(t,e,n){var r=this,i={url:r.baseUrl+"/"+r.apiVersion+e,method:t,headers:{Authorization:r.getAuthorizationHeader(),"X-sdk-variant":"javascript","X-sdk-version":"2.3.5"}};return"POST"!==t&&"PUT"!==t&&"PATCH"!==t||(i.data=n||{}),"GET"===t&&(i.params=n||{}),i},i.prototype.Get=function(t,e,n){var r=this.buildRequestObject("GET",t,e);return this.LAST_REQUEST=r,this.request(r,n)},i.prototype.Post=function(t,e,n){var r=this.buildRequestObject("POST",t,e);return this.LAST_REQUEST=r,this.request(r,n)},i.prototype.Put=function(t,e,n){var r=this.buildRequestObject("PUT",t,e);return this.LAST_REQUEST=r,this.request(r,n)},i.prototype.Patch=function(t,e,n){var r=this.buildRequestObject("PATCH",t,e);return this.LAST_REQUEST=r,this.request(r,n)},i.prototype.Delete=function(t,e){var n=this.buildRequestObject("DELETE",t);return this.LAST_REQUEST=n,this.request(n,e)},e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(){for(var t=!1,e=0;e<u.length;e++){try{t=u[e]()}catch(t){continue}break}return t}Object.defineProperty(e,"__esModule",{value:!0});var s=n(3),o=r(s),u=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],a=["GET","POST","PUT","PATCH","DELETE"],d=function(t,e){if(this.method=t.method,a.indexOf(this.method)<0)throw new Error("Unsupported HTTP method "+this.method);this.url=t.url,this.headers=t.headers||{},this.data=t.data||{},this.params=t.params||{},this.client=e};d.prototype.getFullRequestUri=function(){var t=""+this.url;if("GET"===this.method){t+="?";for(var e in this.params)t+=encodeURI(e+"="+this.params[e])+"&";"&"===t.slice(-1)&&(t=t.slice(0,-1))}return t},d.prototype.send=function(t){return t?this.sendAsCallback(t):this.sendAsPromise()},d.prototype.sendAsPromise=function(){var t=this;return new Promise(function(e,n){var r=i();r.open(t.method,t.getFullRequestUri()),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json");for(var s in t.headers)r.setRequestHeader(s,t.headers[s]);r.onreadystatechange=function(){if(4===r.readyState){if(r.status>=200&&r.status<400)return e(JSON.parse(r.responseText));if(r.status>=400)return t.client.rejectApiErrors===!0?n(JSON.parse(r.responseText)):e(JSON.parse(r.responseText))}},r.onerror=function(){n(new Error("Networking error"))},["PATCH","POST","PUT"].indexOf(t.method)>=0?r.send(JSON.stringify(t.data)):r.send()})},d.prototype.sendAsCallback=function(t){if(!o.default.isFunction(t))throw new Error("Callback must be a Function");var e=i();e.open(this.method,this.getFullRequestUri()),e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("Accept","application/json");for(var n in this.headers)e.setRequestHeader(n,this.headers[n]);e.onreadystatechange=function(){if(4===e.readyState){if(e.status>=200&&e.status<400)return t(null,JSON.parse(e.responseText));if(e.status>=400)return t(JSON.parse(e.responseText))}},e.onerror=function(){return t(new Error("Netowrking error. Please check connectivity"))},["PATCH","POST","PUT"].indexOf(this.method)>=0?e.send(JSON.stringify(this.data)):e.send()},window.request=d,e.default=d},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};n.isFunction=function(t){var e={};return t&&"[object Function]"===e.toString.call(t)},n.canIUsePromises=function(){return"undefined"!=typeof Promise&&Promise.toString().indexOf("[native code]")!==-1},n.uniqueValues=function(t){var e={},n=[];for(var r in t)"undefined"==typeof e[t[r]]&&n.push(t[r]),e[t[r]]=0;return n},n.getVariantValues=function(t,e){if("product_with_variants"!==e.type)return[];var r=e.variants.map(function(e){return e[t]});return n.uniqueValues(r)},n.variantExists=function(t,e){return e.variants.some(function(e){var n=!0;for(var r in t)t[r]!==e[r]&&(n=!1);return n})},n.variantIsAvailable=function(t,e){return"product_with_variants"===e.type&&e.variants.some(function(e){var n=!0,r=!1;for(var i in t)t[i]!==e[i]&&(n=!1);return n&&("track"===e.stock_type&&e.stock_level>0&&(r=!0),"status"===e.stock_type&&"in_stock"===e.stock_status&&(r=!0),"infinite"===e.stock_type&&(r=!0)),n&&r})},n.base64EncodeFileInput=function(t,e){var n=document.querySelector(t),r=n.files[0],i=new FileReader;i.addEventListener("load",function(){e(i.result)},!1),r&&i.readAsDataURL(r)},e.default=n},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),e=function(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return null},n=function(t,e,n){var r=function(){if(n){var t=new Date;return t.setTime(t.getTime()+24*n*60*60*1e3),"; expires="+t.toGMTString()}return""}();document.cookie=t+"="+e+r+"; path=/"};return{prefix:"mrtkcld_",set:function(e,r,i){t?localStorage.setItem(this.prefix+e,r):n(this.prefix+e,r,i)},get:function(n){return t?localStorage.getItem(this.prefix+n):e(this.prefix+n)},delete:function(e){t?localStorage.removeItem(this.prefix+e):this.set(this.prefix+e,"",-1)}}}();window.BrowserStorage=n,e.default=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="addresses",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e){"use strict";function n(t){this.master=t}Object.defineProperty(e,"__esModule",{value:!0}),n.prototype.list=function(t,e){return this.master.Get(this.endpoint,t,e)},n.prototype.getById=function(t,e){if(isNaN(t))throw new Error("id must be an integer.");return this.master.Get(this.endpoint+"/"+t,{},e)},n.prototype.create=function(t,e){return this.master.Post(this.endpoint,t,e)},n.prototype.update=function(t,e,n){if(isNaN(t))throw new Error("id must be an integer.");return this.master.Put(this.endpoint+"/"+t,e,n)},n.prototype.delete=function(t,e){return this.master.Delete(this.endpoint+"/"+t,e)},window.resource=n,e.default=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="brands",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="carts",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,i.prototype.add=function(t,e,n){if(isNaN(t))throw new Error("id must be an integer.");if(!(e instanceof Array))throw new Error("items must be an array of line items");var r={op:"add",items:e};return this.master.Patch("/carts/"+t,r,n)},i.prototype.remove=function(t,e,n){if(isNaN(t))throw new Error("id must be an integer.");if(!(e instanceof Array))throw new Error("items must be an array of line items");var r={op:"remove",items:e};return this.master.Patch("/carts/"+t,r,n)},i.prototype.update=function(t,e,n){if(isNaN(t))throw new Error("id must be an integer.");if(!(e instanceof Array))throw new Error("items must be an array of line items");var r={op:"update",items:e};return this.master.Patch("/carts/"+t,r,n)},i.prototype.addCoupon=function(t,e,n){if(isNaN(t))throw new Error("cartId must be an integer.");if("string"!=typeof e)throw new Error("couponCode must be a string.");var r={coupon_code:e};return this.master.Put("/carts/"+t+"/coupon",r,n)},e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="categories",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="collections",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="contents",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="coupons",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="invoices",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="media",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="orders",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e){"use strict";function n(t){this.master=t,this.name="payments",this.endpoint="/"+this.name,this.braintree={createClientToken:function(e){return t.Post("/integrations/braintree/clientToken",{},e)},create:function(t,e){if(t.method="Braintree",!t.hasOwnProperty("nonce"))throw new Error("Missing required attribute nonce");if(!t.hasOwnProperty("order_id"))throw new Error("Missing required attribute order_id");return this.master.Post("/payments",t,e)}},this.stripe={create:function(t,e){if(t.method="Stripe",!t.hasOwnProperty("source"))throw new Error("Missing required attribute source");if(!t.hasOwnProperty("order_id"))throw new Error("Missing required attribute order_id");return this.master.Post("/payments",t,e)}}}Object.defineProperty(e,"__esModule",{value:!0}),n.prototype.create=function(t){if(!t.hasOwnProperty("order_id"))throw new Error("Missing required attribute order_id");return this.master.Post("/payments",t)},e.default=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="paymentMethods",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="products",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="promotions",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,i.prototype.getByCart=function(t,e){return this.master.Get("/promotions/cart/"+t,{},e)},e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="shippingMethods",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="users",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s),u=n(4),a=r(u);i.prototype=new o.default,i.prototype.authenticate=function(t,e,n){var r={email:t,password:e},i=this;return this.master.Post("/users/authenticate",r).then(function(t){return i.master.token=t.data.token,i.master.currentUser=t.data.user,a.default.set("AuthenticatedUserToken",t.data.token),a.default.set("AuthenticatedUserData",JSON.stringify(i.master.currentUser)),n?n(null,t):new Promise(function(e,n){e(t)})}).catch(function(t){return n?n(t,null):new Promise(function(e,n){n(t)})})},i.prototype.getCurrent=function(t,e){return t===!0?new Promise(function(t,n){return e(null,{data:this.master.currentUser}),t({data:this.master.currentUser})}):this.master.Get("/users",e)},i.prototype.updateCurrent=function(t,e){if(this.master.currentUser)return this.master.Put("/users/"+this.master.currentUser.id,t);throw new Error("Unable to update current user. No user is currently authenticated. Call authenticate() first.")},i.prototype.isAuthenticated=function(){return!!this.master.token},i.prototype.authenticateWithFacebook=function(t,e,n){var r={user_id:t,access_token:e};return this.master.Post("/users/authenticate/facebook",r,n)},i.prototype.logout=function(){this.master.token=null,this.master.currentUser=null,a.default.delete("AuthenticatedUserToken"),a.default.delete("AuthenticatedUserData")},e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){o.default.call(this,t),this.name="variables",this.endpoint="/"+this.name}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6),o=r(s);i.prototype=new o.default,e.default=i}])});